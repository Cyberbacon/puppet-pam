###############################################################################
# << FILE MANAGED BY PUPPET >>
# Manual changes are likey to be overwritten
###############################################################################

<% if scope.lookupvar('pam::pamd::pam_tally2') == true then -%>
account	<%= scope.lookupvar('pam::pamd::pam_tally2_account_set') %>
<% end -%>
account	[success=2 new_authtok_reqd=done default=ignore]	pam_unix.so 
<% if scope.lookupvar('pam::pamd::pam_ldap') == true then -%>
#account	[success=1 default=ignore]	pam_ldap.so 
account	<%= scope.lookupvar('pam::pamd::pam_ldap_account_set') %>
<% end -%>
account	requisite			pam_deny.so
account	required			pam_permit.so
<% if scope.lookupvar('pam::pamd::pam_acl_groups') != 'NONE' then -%>
account required      pam_listfile.so file=/etc/pam_groups.acl item=group sense=allow onerr=fail
<%- end -%>
<% if scope.lookupvar('pam::pamd::pam_acl_users') != 'NONE' then -%>
account required      pam_listfile.so file=/etc/pam_users.acl item=user sense=allow onerr=fail
<%- end -%>
